{"version":3,"sources":["acticle.js"],"names":[],"mappings":";;AAAA;;;;AAIA,IAAI,WAAW,QAAQ,UAAR,CAAf;AACA,IAAI,SAAS,SAAS,MAAtB;AACA,IAAI,WAAW,OAAO,KAAP,CAAa,QAA5B;;AAGA;AACA,IAAI,gBAAgB,IAAI,MAAJ,CAAW;AAC3B,YAAQ,MADmB;AAE3B,WAAO,MAFoB;AAG3B,UAAM,MAHqB;AAI3B,SAAK,MAJsB;AAK3B,YAAQ,MALmB;AAM3B,QAAI;AACA,cAAM,MADN;AAEA,iBAAS;AAFT,KANuB;AAU3B,cAAU;AACN,cAAM,QADA;AAEN,aAAK;AAFC,KAViB;AAc3B,UAAM;AACF,kBAAU;AACN,kBAAM,IADA;AAEN,qBAAS,KAAK,GAAL;AAFH,SADR;AAKF,kBAAU;AACN,kBAAM,IADA;AAEN,qBAAS,KAAK,GAAL;AAFH;AALR;AAdqB,CAAX,CAApB;;AA0BA,cAAc,GAAd,CAAkB,MAAlB,EAA0B,UAAU,IAAV,EAAgB;AACtC,QAAI,KAAK,KAAT,EAAgB;AACZ,aAAK,IAAL,CAAU,QAAV,GAAqB,KAAK,IAAL,CAAU,QAAV,GAAqB,KAAK,GAAL,EAA1C;AACH,KAFD,MAEO;AACH,aAAK,IAAL,CAAU,QAAV,GAAqB,KAAK,GAAL,EAArB;AACH;;AAED;AACH,CARD;;AAUA,cAAc,OAAd,GAAwB;AACpB,WAAO,eAAU,EAAV,EAAc;AACjB,eAAO,KACF,IADE,CACG,EADH,EAEF,IAFE,CAEG,eAFH,EAGF,IAHE,CAGG,EAHH,CAAP;AAIH,KANmB;AAOpB,cAAU,kBAAU,EAAV,EAAc,EAAd,EAAkB;AACxB,eAAO,KACF,OADE,CACM,EAAC,KAAK,EAAN,EADN,EAEF,IAFE,CAEG,EAFH,CAAP;AAGH;AAXmB,CAAxB;;AAeA,OAAO,OAAP,GAAiB,UAAU,aAA3B","file":"acticle-compiled.js","sourcesContent":["/**\n * Created by alfredlau on 2016/8/15.\n */\n\nvar mongoose = require('mongoose');\nvar Schema = mongoose.Schema\nvar ObjectId = Schema.Types.ObjectId;\n\n\n//文章标题,简介,标签,分类,mete信息,封面,作者,访问量\nvar ArticleSchema = new Schema({\n    author: String,\n    title: String,\n    desc: String,\n    tag: String,\n    poster: String,\n    pv: {\n        type: Number,\n        default: 0,\n    },\n    category: {\n        type: ObjectId,\n        ref: 'Category',\n    },\n    meta: {\n        createAt: {\n            type: Date,\n            default: Date.now(),\n        },\n        updateAt: {\n            type: Date,\n            default: Date.now(),\n        },\n    },\n});\n\nArticleSchema.pre('save', function (next) {\n    if (this.isNew) {\n        this.meta.createAt = this.meta.updateAt = Date.now();\n    } else {\n        this.meta.updateAt = Date.now();\n    }\n\n    next()\n});\n\nArticleSchema.statics = {\n    fetch: function (cb) {\n        return this\n            .find({})\n            .sort('meta.updateAt')\n            .exec(cb);\n    },\n    findById: function (id, cb) {\n        return this\n            .findOne({_id: id})\n            .exec(cb);\n    }\n};\n\n\nmodule.exports = exports = ArticleSchema;"]}