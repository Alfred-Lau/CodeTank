{"version":3,"sources":["category.js"],"names":[],"mappings":";;AAAA;;;AAGA,IAAI,WAAW,QAAQ,UAAR,CAAf;AACA,IAAI,SAAS,SAAS,MAAtB;AACA,IAAI,WAAW,OAAO,KAAP,CAAa,QAA5B;;AAEA,IAAI,iBAAiB,IAAI,MAAJ,CAAW;AAC5B,UAAM,MADsB;AAE5B,cAAU,CAAC,EAAC,MAAM,QAAP,EAAiB,KAAK,SAAtB,EAAD,CAFkB;AAG5B,UAAM;AACF,kBAAU;AACN,kBAAM,IADA;AAEN,qBAAS,KAAK,GAAL;AAFH,SADR;AAKF,kBAAU;AACN,kBAAM,IADA;AAEN,qBAAS,KAAK,GAAL;AAFH;AALR;AAHsB,CAAX,CAArB;;AAeA,eAAe,GAAf,CAAmB,MAAnB,EAA2B,UAAU,IAAV,EAAgB;AACvC,QAAI,KAAK,KAAT,EAAgB;AACZ,aAAK,IAAL,CAAU,QAAV,GAAqB,KAAK,IAAL,CAAU,QAAV,GAAqB,KAAK,GAAL,EAA1C;AACH,KAFD,MAEO;AACH,aAAK,IAAL,CAAU,QAAV,GAAqB,KAAK,GAAL,EAArB;AACH;;AAGD;AACH,CATD;;AAYA,eAAe,OAAf,GAAyB;AACrB,WAAO,eAAU,EAAV,EAAc;AACjB,eAAO,KACF,IADE,CACG,EADH,EAEF,IAFE,CAEG,eAFH,EAGF,IAHE,CAGG,EAHH,CAAP;AAIH,KANoB;AAOrB,cAAU,kBAAU,EAAV,EAAc,EAAd,EAAkB;AACxB,eAAO,KACF,OADE,CACM,EAAC,KAAK,EAAN,EADN,EAEF,IAFE,CAEG,EAFH,CAAP;AAGH;AAXoB,CAAzB;;AAeA,OAAO,OAAP,GAAiB,UAAU,cAA3B","file":"category-compiled.js","sourcesContent":["/**\n * Created by alfredlau on 2016/8/15.\n */\nvar mongoose = require('mongoose');\nvar Schema = mongoose.Schema;\nvar ObjectId = Schema.Types.ObjectId;\n\nvar CategorySchema = new Schema({\n    name: String,\n    articles: [{type: ObjectId, ref: 'article'}],\n    meta: {\n        createAt: {\n            type: Date,\n            default: Date.now(),\n        },\n        updateAt: {\n            type: Date,\n            default: Date.now(),\n        },\n    }\n})\n\nCategorySchema.pre('save', function (next) {\n    if (this.isNew) {\n        this.meta.createAt = this.meta.updateAt = Date.now();\n    } else {\n        this.meta.updateAt = Date.now();\n    }\n\n\n    next()\n})\n\n\nCategorySchema.statics = {\n    fetch: function (cb) {\n        return this\n            .find({})\n            .sort('meta.updateAt')\n            .exec(cb);\n    },\n    findById: function (id, cb) {\n        return this\n            .findOne({_id: id})\n            .exec(cb);\n    },\n}\n\n\nmodule.exports = exports = CategorySchema"]}