{"version":3,"sources":["bs-lessdoc-parser.js"],"names":[],"mappings":"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","file":"bs-lessdoc-parser-compiled.js","sourcesContent":["/*!\n * Bootstrap Grunt task for parsing Less docstrings\n * http://getbootstrap.com\n * Copyright 2014 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n */\n'use strict';\n\nvar markdown = require('markdown').markdown;\n\nfunction markdown2html(markdownString) {\n  // the slice removes the <p>...</p> wrapper output by Markdown processor\n  return markdown.toHTML(markdownString.trim()).slice(3, -4);\n}\n\n\n/*\nMini-language:\n  //== This is a normal heading, which starts a section. Sections group variables together.\n  //## Optional description for the heading\n\n  //=== This is a subheading.\n\n  //** Optional description for the following variable. You **can** use Markdown in descriptions to discuss `<html>` stuff.\n  @foo: #ffff;\n\n  //-- This is a heading for a section whose variables shouldn't be customizable\n\n  All other lines are ignored completely.\n*/\n\n\nvar CUSTOMIZABLE_HEADING = /^[/]{2}={2}(.*)$/;\nvar UNCUSTOMIZABLE_HEADING = /^[/]{2}-{2}(.*)$/;\nvar SUBSECTION_HEADING = /^[/]{2}={3}(.*)$/;\nvar SECTION_DOCSTRING = /^[/]{2}#{2}(.*)$/;\nvar VAR_ASSIGNMENT = /^(@[a-zA-Z0-9_-]+):[ ]*([^ ;][^;]+);[ ]*$/;\nvar VAR_DOCSTRING = /^[/]{2}[*]{2}(.*)$/;\n\nfunction Section(heading, customizable) {\n  this.heading = heading.trim();\n  this.id = this.heading.replace(/\\s+/g, '-').toLowerCase();\n  this.customizable = customizable;\n  this.docstring = null;\n  this.subsections = [];\n}\n\nSection.prototype.addSubSection = function (subsection) {\n  this.subsections.push(subsection);\n};\n\nfunction SubSection(heading) {\n  this.heading = heading.trim();\n  this.id = this.heading.replace(/\\s+/g, '-').toLowerCase();\n  this.variables = [];\n}\n\nSubSection.prototype.addVar = function (variable) {\n  this.variables.push(variable);\n};\n\nfunction VarDocstring(markdownString) {\n  this.html = markdown2html(markdownString);\n}\n\nfunction SectionDocstring(markdownString) {\n  this.html = markdown2html(markdownString);\n}\n\nfunction Variable(name, defaultValue) {\n  this.name = name;\n  this.defaultValue = defaultValue;\n  this.docstring = null;\n}\n\nfunction Tokenizer(fileContent) {\n  this._lines = fileContent.split('\\n');\n  this._next = undefined;\n}\n\nTokenizer.prototype.unshift = function (token) {\n  if (this._next !== undefined) {\n    throw new Error('Attempted to unshift twice!');\n  }\n  this._next = token;\n};\n\nTokenizer.prototype._shift = function () {\n  // returning null signals EOF\n  // returning undefined means the line was ignored\n  if (this._next !== undefined) {\n    var result = this._next;\n    this._next = undefined;\n    return result;\n  }\n  if (this._lines.length <= 0) {\n    return null;\n  }\n  var line = this._lines.shift();\n  var match = null;\n  match = SUBSECTION_HEADING.exec(line);\n  if (match !== null) {\n    return new SubSection(match[1]);\n  }\n  match = CUSTOMIZABLE_HEADING.exec(line);\n  if (match !== null) {\n    return new Section(match[1], true);\n  }\n  match = UNCUSTOMIZABLE_HEADING.exec(line);\n  if (match !== null) {\n    return new Section(match[1], false);\n  }\n  match = SECTION_DOCSTRING.exec(line);\n  if (match !== null) {\n    return new SectionDocstring(match[1]);\n  }\n  match = VAR_DOCSTRING.exec(line);\n  if (match !== null) {\n    return new VarDocstring(match[1]);\n  }\n  var commentStart = line.lastIndexOf('//');\n  var varLine = (commentStart === -1) ? line : line.slice(0, commentStart);\n  match = VAR_ASSIGNMENT.exec(varLine);\n  if (match !== null) {\n    return new Variable(match[1], match[2]);\n  }\n  return undefined;\n};\n\nTokenizer.prototype.shift = function () {\n  while (true) {\n    var result = this._shift();\n    if (result === undefined) {\n      continue;\n    }\n    return result;\n  }\n};\n\nfunction Parser(fileContent) {\n  this._tokenizer = new Tokenizer(fileContent);\n}\n\nParser.prototype.parseFile = function () {\n  var sections = [];\n  while (true) {\n    var section = this.parseSection();\n    if (section === null) {\n      if (this._tokenizer.shift() !== null) {\n        throw new Error('Unexpected unparsed section of file remains!');\n      }\n      return sections;\n    }\n    sections.push(section);\n  }\n};\n\nParser.prototype.parseSection = function () {\n  var section = this._tokenizer.shift();\n  if (section === null) {\n    return null;\n  }\n  if (!(section instanceof Section)) {\n    throw new Error('Expected section heading; got: ' + JSON.stringify(section));\n  }\n  var docstring = this._tokenizer.shift();\n  if (docstring instanceof SectionDocstring) {\n    section.docstring = docstring;\n  }\n  else {\n    this._tokenizer.unshift(docstring);\n  }\n  this.parseSubSections(section);\n\n  return section;\n};\n\nParser.prototype.parseSubSections = function (section) {\n  while (true) {\n    var subsection = this.parseSubSection();\n    if (subsection === null) {\n      if (section.subsections.length === 0) {\n        // Presume an implicit initial subsection\n        subsection = new SubSection('');\n        this.parseVars(subsection);\n      }\n      else {\n        break;\n      }\n    }\n    section.addSubSection(subsection);\n  }\n\n  if (section.subsections.length === 1 && !(section.subsections[0].heading) && section.subsections[0].variables.length === 0) {\n    // Ignore lone empty implicit subsection\n    section.subsections = [];\n  }\n};\n\nParser.prototype.parseSubSection = function () {\n  var subsection = this._tokenizer.shift();\n  if (subsection instanceof SubSection) {\n    this.parseVars(subsection);\n    return subsection;\n  }\n  this._tokenizer.unshift(subsection);\n  return null;\n};\n\nParser.prototype.parseVars = function (subsection) {\n  while (true) {\n    var variable = this.parseVar();\n    if (variable === null) {\n      return;\n    }\n    subsection.addVar(variable);\n  }\n};\n\nParser.prototype.parseVar = function () {\n  var docstring = this._tokenizer.shift();\n  if (!(docstring instanceof VarDocstring)) {\n    this._tokenizer.unshift(docstring);\n    docstring = null;\n  }\n  var variable = this._tokenizer.shift();\n  if (variable instanceof Variable) {\n    variable.docstring = docstring;\n    return variable;\n  }\n  this._tokenizer.unshift(variable);\n  return null;\n};\n\n\nmodule.exports = Parser;\n"]}